javascript:(function(){(()=>{var c=[{name:"Google",url:"https://www.google.com/search?q=%s",identifier:"google.com",queryGetter:()=>new URLSearchParams(window.location.search).get("q")},{name:"Perplexity",url:"https://www.perplexity.ai/?q=%s",identifier:"perplexity.ai",queryGetter:()=>document.querySelector("h1")?.innerText??null},{name:"\u5FC5\u5E94",url:"https://www.bing.com/search?q=%s",identifier:"bing.com",queryGetter:()=>new URLSearchParams(window.location.search).get("q")},{name:"\u767E\u5EA6",url:"https://www.baidu.com/s?wd=%s",identifier:"baidu.com",queryGetter:()=>new URLSearchParams(window.location.search).get("wd")}];function f(){let t=window.location.href,r=c.find(l=>t.includes(l.identifier));if(!r)throw new Error("\u672A\u627E\u5230\u5339\u914D\u7684\u641C\u7D22\u5F15\u64CE");return r.queryGetter()}async function h(){let t="search-engine-switch-last-use",r=localStorage.getItem(t)??c[0].name,n,l=new Promise((e,o)=>{n=y(c,r,{resolve:e,reject:o})});try{let e=await l;return localStorage.setItem(t,e.name),e}catch(e){return e===null?null:(alert("\u51FA\u73B0\u9519\u8BEF\uFF0C\u4F7F\u7528\u9ED8\u8BA4 ".concat(c[0].name," \u5F15\u64CE\uFF1A")+e.message),c[0])}finally{n()}}function y(t,r,n){if(document.querySelector(".ses-dialog"))return n.reject(null),()=>{};let e=document.createElement("dialog"),o=document.querySelector("#ses-dialog-style");o||(o=document.createElement("style"),o.id="ses-dialog-style");let u=()=>{e.remove(),o.remove()};e.classList.add("ses-dialog"),o.innerHTML='\n    .ses-dialog {\n      width: 300px;\n      max-width: 90%;\n      border-radius: 8px;\n      border: none;\n      padding: 16px;\n      font-family: system-ui, sans-serif;\n      color: white;\n      background-color: black;\n    }\n    .ses-title {\n      font-size: 1.5em;\n      font-weight: bold;\n    }\n    #ses-engines-list {\n      margin-top: 16px;\n      display: grid;\n      gap: 8px;\n      grid-template-columns: 1fr;\n      label {\n        display: flex;\n        align-items: center;\n        input[type="radio"] {\n          margin-right: 8px;\n        }\n      }\n    }\n    .ses-button-group {\n      margin-top: 16px;\n      display: flex;\n      gap: 8px;\n      justify-content: flex-end;\n      button {\n        padding: 8px 16px;\n        border: none;\n        border-radius: 4px;\n        cursor: pointer;\n      }\n      .cancel-btn {\n        background-color:rgba(248, 249, 250, 0.27);\n      }\n      .submit-btn {\n        background-color: #007bff;\n        color: white;\n      }\n    }\n\n  ',e.innerHTML='\n    <form method="dialog">\n      <p class="ses-title">\u9009\u62E9\u641C\u7D22\u5F15\u64CE</p>\n      <div id="ses-engines-list"></div>\n      <div class="ses-button-group">\n        <button type="button" class="cancel-btn" id="ses-cancelBtn">\u53D6\u6D88</button>\n        <button type="submit" class="submit-btn">\u786E\u8BA4\u63D0\u4EA4</button>\n      </div>\n    </form>\n  ';let m=e.querySelector("#ses-engines-list");if(!m)return n.reject(new Error("\u672A\u627E\u5230\u641C\u7D22\u5F15\u64CE\u9009\u62E9\u6846")),u;t.forEach(a=>{let i=document.createElement("input");i.type="radio",i.name="engine",i.value=a.name,i.id="engine-".concat(a.name),a.name===r&&(i.checked=!0);let s=document.createElement("label");s.htmlFor="engine-".concat(a.name),s.appendChild(i),s.appendChild(document.createTextNode(a.name)),m.appendChild(s)});let g=e.querySelector("form");g?.addEventListener("submit",a=>{a.preventDefault();let s=new FormData(g).get("engine");if(!s){n.reject(new Error("\u672A\u9009\u62E9\u641C\u7D22\u5F15\u64CE"));return}let p=t.find(w=>w.name===s);if(!p){n.reject(new Error("\u672A\u627E\u5230\u5339\u914D\u7684\u641C\u7D22\u5F15\u64CE"));return}n.resolve(p),e.close()}),e.querySelector("#ses-cancelBtn")?.addEventListener("click",()=>{n.reject(null),e.close()});let d=document.createDocumentFragment();return d.appendChild(e),d.appendChild(o),document.body.appendChild(d),e.showModal(),u}function b(t,r){let n=r.url.replace("%s",encodeURIComponent(t));window.open(n,"_blank")}async function x(){let t=f();if(!t)throw new Error("\u672A\u627E\u5230\u641C\u7D22\u5173\u952E\u8BCD");let r=await h();r&&b(t,r)}x().catch(t=>{alert("Search Engine Switch Error: "+t.message)});})();})()